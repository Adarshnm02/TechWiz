<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="UTF-8" />
    <meta name="description" content="Ogani Template" />
    <meta name="keywords" content="Ogani, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>TechWiz</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;900&display=swap"
        rel="stylesheet" />


    <!-- Css Styles -->
    <link rel="stylesheet" href="/user/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/user/css/user.css" type="text/css" />

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">


    <script>$(document).ready(function () {
            $('.toggle-btn').on('click', function () {
                $('.departments-list').slideToggle(); // Toggle visibility of departments list
            });
        });
    </script>

    <style>
        /* Adjust the z-index and position of the departments list */
        .hero__categories {
            position: relative;
            /* Ensure it's a positioned element for z-index to work */
        }
        .hero {
            padding-bottom: 0;
        }

        .departments-list {
            position: absolute;
            top: 100%;
            /* Position it below the "All departments" button */
            left: 0;
            background-color: white;
            /* Set background color as needed */
            z-index: 1000;
            /* Set a higher z-index to overlap other content */
            /* Additional styling */
            width: 260px;
        }
    </style>

</head>

<body>
    <!-- Page Preloder -->
    <div id="preloder">
        <div class="loader"></div>
    </div>

    <!-- Humberger Begin -->

    <div class="humberger__menu__overlay"></div>
    <div class="humberger__menu__wrapper">
        <div class="humberger__menu__logo">
            <a href="#"><img src="/user/img/logo.png" alt=""></a>
        </div>
        <div class="humberger__menu__cart">
            <ul>
                <li>
                    <a href="#"><i class="fa fa-heart"></i> <span>0</span></a>
                </li>
                <li>
                    <!-- <a href="/cart"><i class="fa fa-shopping-bag"></i> <span>3</span></a> -->
                    <a href="/cart"><i class="fa fa-shopping-bag"></i> <span id="cartLen"><% if(cartLen){%>
                        <%= cartLen %>
                    <%} else {%>
                    0 <%}%></span></a>
                </li>
                <li>
                    <a href="/profile"><i class="fa solid fa-user"></i></a>
                </li>
            </ul>
            <!-- <div class="header__cart__price">item: <span>$150.00</span></div> -->
        </div>
        <div class="humberger__menu__widget">
            <div class="header__top__right__language">
                <img src="/user/img/language.png" alt="" />
                <div>English</div>
                <span class="arrow_carrot-down"></span>
                <ul>
                    <li><a href="#">Spanis</a></li>
                    <li><a href="#">English</a></li>
                </ul>
            </div>
            <div class="header__top__right__auth">
                <% if (session) { %>
                    <li><a href="/logout"><i class="fa fa-sign-out"></i> Logout</a></li>
                    <% } else { %>
                        <li><a href="/login"><i class="fa fa-user"></i> Login</a></li>
                        <% } %>
            </div>

        </div>
        <nav class="humberger__menu__nav mobile-menu">
            <ul>
                <li class="active"><a href="/">Home</a></li>
                <li><a href="/shop-grid">Shop</a></li>
                <li>
                    <a href="#">Pages</a>
                    <ul class="header__menu__dropdown">
                        <!-- <li><a href="./shop-details.html">Shop Details</a></li> -->
                        <li><a href="/cart">Shoping Cart</a></li>
                        <li><a href="/checkout">Check Out</a></li>
                        <!-- <li><a href="./blog-details.html">Blog Details</a></li> -->
                    </ul>
                </li>
                <li><a href="./blog.html">Blog</a></li>
                <li><a href="./contact.html">Contact</a></li>
            </ul>
        </nav>
        <div id="mobile-menu-wrap"></div>
        <div class="header__top__right__social">
            <a href="#"><i class="fa fa-facebook"></i></a>
            <a href="#"><i class="fa fa-twitter"></i></a>
            <a href="#"><i class="fa fa-linkedin"></i></a>
            <a href="#"><i class="fa fa-pinterest-p"></i></a>
        </div>
        <div class="humberger__menu__contact">
            <ul>
                <li><i class="fa fa-envelope"></i> techwiz@gmail.com</li>
                <li>Free Shipping for all Order of ₹99</li>
            </ul>
        </div>
    </div>
    <!-- Humberger End -->



    <!-- Header Section Begin -->
    <header class="header">
        <div class="header__top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="header__top__left">
                            <ul>
                                <li><i class="fa fa-envelope"></i> techwiz@gmail.com</li>
                                <li>Free Shipping for all Order of ₹99</li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="header__top__right">
                            <div class="header__top__right__social">
                                <a href="#"><i class="fa fa-facebook"></i></a>
                                <a href="#"><i class="fa fa-twitter"></i></a>
                                <a href="#"><i class="fa fa-linkedin"></i></a>
                                <a href="#"><i class="fa fa-pinterest-p"></i></a>
                            </div>
                            <div class="header__top__right__language">
                                <img src="/user/img/language.png" alt="" />
                                <div>English</div>
                                <span class="arrow_carrot-down"></span>
                                <ul>
                                    <li><a href="#">Spanis</a></li>
                                    <li><a href="#">English</a></li>
                                </ul>
                            </div>
                            <div class="header__top__right__auth">
                                <% if (session) { %>
                                    <li><a href="/logout"><i class="fa fa-sign-out"></i> Logout</a></li>
                                    <% } else { %>
                                        <li><a href="/login"><i class="fa fa-user"></i> Login</a></li>
                                        <% } %>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="header__logo">
                        <a href="/"><img src="/user/img/new-logo.png" alt="" style="max-width: 50%;" /></a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <nav class="header__menu">
                        <ul>
                            <li class="active"><a href="/">Home</a></li>
                            <li><a href="/shop-grid">Shop</a></li>
                            <li>
                                <a href="#">Pages</a>
                                <ul class="header__menu__dropdown">
                                    <!-- <li><a href="./shop-details.html">Shop Details</a></li> -->
                                    <li><a href="/cart">Shoping Cart</a></li>
                                    <li><a href="/checkout">Check Out</a></li>
                                    <!-- <li><a href="./blog-details.html">Blog Details</a></li> -->
                                </ul>
                            </li>
                            <li><a href="/">Blog</a></li>
                            <li><a href="./contact.html">Contact</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-lg-3">
                    <div class="header__cart">
                        <ul>
                            <li>
                                <a href="#"><i class="fa fa-heart"></i> <span>0</span></a>
                            </li>
                            <li>
                                
                                <a href="/cart"><i class="fa fa-shopping-bag"></i> <span id="cartLeng"><% if(cartLen){%>
                                    <%= cartLen %>
                                <%} else {%>
                                0 <%}%></span></a>
                            </li>
                            <li>
                                <!-- <a href="/profile"><img class="fa user_avathar" src="/user/img/user-1.jpg"
                                        alt="user-avathar"></a> -->
                                
                                        <a href="/profile"><i class="fa solid fa-user"></i></a>
                            </li>
                        </ul>
                        <!-- <div class="header__cart__price">item: <span>$150.00</span></div> -->
                    </div>
                </div>
            </div>
            <div class="humberger__open">
                <i class="fa fa-bars"></i>
            </div>
        </div>
    </header>
    <!-- Header Section End -->





    <!-- Hero Section Begin -->
    <section class="hero">
        <div class="container">
            <div class="row">
                <div class="col-lg-3">
                    <div class="hero__categories">
                        <div class="hero__categories__all">
                            <i class="fa fa-bars"></i>
                            <span class="toggle-btn">All departments</span>
                        </div>
                        <ul class="departments-list" style="display: none;">
                            <% categorys.forEach(category =>{ %>
                                <li><a href="#" onclick="categoryFilter('<%=category._id%>')"><%=category.categoryName%></a></li>
                        <%})%>

                            <!-- <li><a href="#" onclick="categoryFilter('Mobile')">Mobile</a></li>
                            <li><a href="#" onclick="categoryFilter('Laptop')">Laptop</a></li>
                            <li><a href="#" onclick="categoryFilter('Camera')">Camera</a></li>
                            <li><a href="#" onclick="categoryFilter('All')">All</a></li> -->
                        </ul>

                        
                    </div>
                </div>
                <div class="col-lg-9">
                    <div class="hero__search">
                        
                        
                        <div class="hero__search__form">
                            <form action="/index" method="GET"> <!-- Update action attribute -->
                                <input type="text" name="query" placeholder="What do you need?" /> 
                                <button type="submit" class="site-btn">SEARCH</button>
                            </form>
                        </div>
                        


                        <div class="hero__search__phone">
                            <div class="hero__search__phone__icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <div class="hero__search__phone__text">
                                <h5>+91 96.188.888</h5>
                                <span>support 24/7 time</span>
                            </div>
                        </div>
                    </div>

                    <!-- <div class="hero__item set-bg" data-setbg="/user/img/banner/Banner.jpg" style="height: 356px;"> -->
                    <!-- <div class="hero__text">
                            <span>FRUIT FRESH</span>
                            <h2>Vegetable <br />100% Organic</h2>
                            <p>Free Pickup and Delivery Available</p>
                            <a href="#" class="primary-btn">SHOP NOW</a>
                        </div> -->
                </div>
            </div>
        </div>
        </div>
    </section>
    <!-- Hero Section End -->

    <script>
        async function categoryFilter(category) {
          console.log(category, "asdfgasdf");
      
          // Make a POST request
          let response = await fetch('/filterCategory', {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json'
              },
              body: JSON.stringify({ category })
          });
      
          // // Handle the response if needed
          if (response.ok) {
              const data = await response.json();
              console.log('Response data:', data);
              let showProducts = document.getElementById("product_list")
              showProducts.innerHTML = ''
      
              data.products.forEach(element => {
                  let div = document.createElement('div')
                  div.classList.add('col-lg-4', 'col-md-6', 'col-sm-6')
                  div.innerHTML = `
                
                <div class="product__item">
      
      <div class="product__item__pic set-bg"
          style="display: flex; justify-content: center;">
         
              <img onclick="productDetails('${element._id}')" src="data: ${element.image[0].contentType};base64, ${element.image[0].data.toString('base64')}"
                  alt="IMG-PRODUCT" style="height: 260.34px" />
             
                      <ul class="product__item__pic__hover">
                          <li><a href="#"><i class="fa fa-heart"></i></a></li>
                          <li><a onclick="addToCart('${element._id}')"><i
                                      class="fa fa-shopping-cart"></i></a>
                          </li>
                      </ul>
      </div>
      <div class="product__item__text" >
          <h6><a href="/product/Details/${element._id}">
                  ${element.product_name}
              </a>
              <h6>₹${element.price}</h6>
          </h6>
      </div>
      </div>
                
                
                `
                  showProducts.appendChild(div)
              })
      
          } else {
              console.error('Error:', response.status, response.statusText);
          }
      }
      </script>


<script>
    function addToCart(productId) {
   const data = { product: productId };
   fetch('/addtocart', {
       method: 'POST',
       headers: {
           'Content-Type': 'application/json',
       },
       body: JSON.stringify(data),
   })
   .then(response => response.json())
   .then(data => {
       console.log('Success of length:', data.cartLen);
       
       document.getElementById("cartLeng").innerHTML = data.cartLen
       document.getElementById("cartLen").innerHTML = data.cartLen

       // Show SweetAlert toast notification on success
       Swal.fire({
           icon: 'success',
           title: 'Product added to cart',
           position: 'top-end',
           showConfirmButton: false,
           timer: 2000,
           timerProgressBar: true,
           toast: true,
           didOpen: (toast) => {
               toast.addEventListener('mouseenter', Swal.stopTimer);
               toast.addEventListener('mouseleave', Swal.resumeTimer);
           }
       });
   })
   .catch((error) => {
       console.error('Error:', error);

       // Show SweetAlert error toast notification on failure
       Swal.fire({
           icon: 'error',
           title: 'Failed to add product to cart',
           position: 'top-end',
           showConfirmButton: false,
           timer: 3000,
           timerProgressBar: true,
           toast: true,
           didOpen: (toast) => {
               toast.addEventListener('mouseenter', Swal.stopTimer);
               toast.addEventListener('mouseleave', Swal.resumeTimer);
           }
       });
   });
}

</script>
      

</body>

</html>

